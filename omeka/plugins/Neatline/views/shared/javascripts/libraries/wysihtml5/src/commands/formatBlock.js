(function(f){function j(a){for(a=a.previousSibling;a&&a.nodeType===f.TEXT_NODE&&!f.lang.string(a.data).trim();)a=a.previousSibling;return a}function k(a){for(a=a.nextSibling;a&&a.nodeType===f.TEXT_NODE&&!f.lang.string(a.data).trim();)a=a.nextSibling;return a}function l(a){return a.nodeName==="BR"?!0:g.getStyle("display").from(a)==="block"?!0:!1}function o(a,d,b,c){if(c)var h=g.observe(a,"DOMNodeInserted",function(a){a=a.target;a.nodeType===f.ELEMENT_NODE&&g.getStyle("display").from(a).substr(0,6)!==
"inline"&&(a.className+=" "+c)});a.execCommand(d,!1,b);h&&h.stop()}function p(a,d){a.selection.selectLine();a.selection.surround(d);var b=k(d),c=j(d);b&&b.nodeName==="BR"&&b.parentNode.removeChild(b);c&&c.nodeName==="BR"&&c.parentNode.removeChild(c);(b=d.lastChild)&&b.nodeName==="BR"&&b.parentNode.removeChild(b);a.selection.selectNode(d)}var g=f.dom,m="H1,H2,H3,H4,H5,H6,P,BLOCKQUOTE,DIV".split(",");f.commands.formatBlock={exec:function(a,d,b,c,h){var i=a.doc,e=this.state(a,d,b,c,h),n,b=typeof b===
"string"?b.toUpperCase():b;if(e)a.selection.executeAndRestoreSimple(function(){if(h)e.className=e.className.replace(h,"");var a=!!f.lang.string(e.className).trim();if(!a&&e.nodeName===(b||"DIV")){var a=e,c=a.ownerDocument,d=k(a),i=j(a);d&&!l(d)&&a.parentNode.insertBefore(c.createElement("br"),d);i&&!l(i)&&a.parentNode.insertBefore(c.createElement("br"),a);g.replaceWithChildNodes(e)}else a&&g.renameElement(e,"DIV")});else{if(b===null||f.lang.array(m).contains(b))if(n=a.selection.getSelectedNode(),
e=g.getParentElement(n,{nodeName:m})){a.selection.executeAndRestoreSimple(function(){b&&(e=g.renameElement(e,b));if(c){var a=e;a.className?(a.className=a.className.replace(h,""),a.className+=" "+c):a.className=c}});return}if(a.commands.support(d))o(i,d,b||"DIV",c);else{e=i.createElement(b||"DIV");if(c)e.className=c;p(a,e)}}},state:function(a,d,b,c,f){b=typeof b==="string"?b.toUpperCase():b;a=a.selection.getSelectedNode();return g.getParentElement(a,{nodeName:b,className:c,classRegExp:f})},value:function(){}}})(wysihtml5);
