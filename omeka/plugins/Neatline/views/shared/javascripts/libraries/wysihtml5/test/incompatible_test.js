module("wysihtml5 - Incompatible",{setup:function(){this.originalSupportCheck=wysihtml5.browser.supported;wysihtml5.browser.supported=function(){return!1};this.textareaElement=document.createElement("textarea");document.body.appendChild(this.textareaElement)},teardown:function(){wysihtml5.browser.supported=this.originalSupportCheck;this.textareaElement.parentNode.removeChild(this.textareaElement)}});
asyncTest("Basic test",function(){expect(12);var b=this,c=document.getElementsByTagName("iframe").length,d=document.getElementsByTagName("input").length,a=new wysihtml5.Editor(this.textareaElement);a.observe("load",function(){ok(!0,"'load' event correctly triggered");ok(!wysihtml5.dom.hasClass(document.body,"wysihtml5-supported"),"<body> didn't receive the 'wysihtml5-supported' class");ok(!a.isCompatible(),"isCompatible returns false when rich text editing is not correctly supported in the current browser");
equal(b.textareaElement.style.display,"","Textarea is visible");ok(!a.composer,"Composer not initialized");equal(document.getElementsByTagName("iframe").length,c,"No hidden field has been inserted into the dom");equal(document.getElementsByTagName("input").length,d,"Composer not initialized");a.setValue("foobar<br>");equal(b.textareaElement.value,"foobar<br>");equal(a.getValue(),"foobar<br>");a.clear();equal(b.textareaElement.value,"");a.observe("focus",function(){ok(!0,"Generic 'focus' event fired")});
a.observe("focus:textarea",function(){ok(!0,"Specific 'focus:textarea' event fired")});a.observe("focus:composer",function(){ok(!1,"Specific 'focus:composer' event fired, and that's wrong, there shouldn't be a composer element/view")});QUnit.triggerEvent(b.textareaElement,wysihtml5.browser.supportsEvent("focusin")?"focusin":"focus");start()})});
