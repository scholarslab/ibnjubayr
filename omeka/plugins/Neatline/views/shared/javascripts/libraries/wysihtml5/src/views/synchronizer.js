(function(d){d.views.Synchronizer=Base.extend({constructor:function(a,b,c){this.editor=a;this.textarea=b;this.composer=c;this._observe()},fromComposerToTextarea:function(a){this.textarea.setValue(d.lang.string(this.composer.getValue()).trim(),a)},fromTextareaToComposer:function(a){var b=this.textarea.getValue();b?this.composer.setValue(b,a):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(a){this.editor.currentView.name==="textarea"?this.fromTextareaToComposer(a):this.fromComposerToTextarea(a)},
_observe:function(){var a,b=this,c=this.textarea.element.form,e=function(){a=setInterval(function(){b.fromComposerToTextarea()},400)},f=function(){clearInterval(a);a=null};e();c&&(d.dom.observe(c,"submit",function(){b.sync(!0)}),d.dom.observe(c,"reset",function(){setTimeout(function(){b.fromTextareaToComposer()},0)}));this.editor.observe("change_view",function(c){c==="composer"&&!a?(b.fromTextareaToComposer(!0),e()):c==="textarea"&&(b.fromComposerToTextarea(!0),f())});this.editor.observe("destroy:composer",
f)}})})(wysihtml5);
